<!-- HTML header for doxygen 1.12.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>P4 Compiler Documentation (P4C): Contribute to the P4 Compiler Project</title>
<link rel="icon" href="p4-fav.svg" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--  Add link to paragraphs   -->
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
  DoxygenAwesomeParagraphLink.init()
</script>
<!-- Add copy button to code fragments  -->
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
  DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add dark mode toggle -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="cards.css" rel="stylesheet" type="text/css"/>
<link href="flow.css" rel="stylesheet" type="text/css"/>
<link href="p4c_custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="p4-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">P4C
   </div>
   <div id="projectbrief">The P4 Compiler</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('contribute.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Contribute to the P4 Compiler Project</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1 empty">
    <ul>
      <li class="level2">
        <a href="#contributing-license">Contributing License</a>
      </li>
      <li class="level2">
        <a href="#coding-standard-philosophy">Coding Standard Philosophy</a>
      </li>
      <li class="level2">
        <a href="#how-to-contribute-1">How to Contribute</a>
        <ul>
          <li class="level3">
            <a href="#guidelines">Guidelines</a>
          </li>
          <li class="level3">
            <a href="#finding-a-task">Finding a Task</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#reporting-issues">Reporting Issues</a>
      </li>
      <li class="level2">
        <a href="#feature-requests">Feature Requests</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#coding-standard">Coding Standard</a>
    <ul>
      <li class="level2">
        <a href="#commenting-the-code">Commenting the code</a>
      </li>
      <li class="level2">
        <a href="#handling-errors">Handling errors</a>
      </li>
      <li class="level2">
        <a href="#git-commits-and-pull-requests">Git commits and pull requests</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p>Thank you for considering contributing to the P4 Compiler Project (P4C)! Your contributions are valuable and help improve the project for everyone. Before getting started, please take a moment to review the following guidelines.</p>
<h2><a class="anchor" id="contributing-license"></a>
Contributing License</h2>
<p>The P4 organizations uses <a href="https://en.wikipedia.org/wiki/Developer_Certificate_of_Origin">DCO</a> for contributions. Please take a look at our <a href="https://github.com/p4lang/governance/wiki/P4-DCO-Guidelines">guidelines</a>.</p>
<p>To sign off the last commit quickly use the <code>git commit --amend --signoff</code> command. The failing check will also include instructions on how to sign off all commits in two steps (using <code>git rebase HEAD~$NUM_COMMITS --signoff</code>). The <a href="https://github.com/src-d/guide/blob/master/developer-community/fix-DCO.md#dco-is-missing">Developer Community DCO guide</a> also provides helpful tips on fixing DCO inconveniences. Setting up a commit hook in the P4C repository will automate adding the DCO signoff.</p>
<h2><a class="anchor" id="coding-standard-philosophy"></a>
Coding Standard Philosophy</h2>
<p>Please note that this project adheres to the P4 Coding Standard Philosophy. By participating, you are expected to uphold this code.</p>
<h2><a class="anchor" id="how-to-contribute-1"></a>
How to Contribute</h2>
<p>We welcome and appreciate new contributions. Check out <a class="el" href="repository_structure.html#git-usage">git usage</a> to get started.</p>
<h3><a class="anchor" id="guidelines"></a>
Guidelines</h3>
<ul>
<li>Writing unit test code <a class="el" href="repository_structure.html#adding-new-test-data">Guidelines</a>.</li>
<li>Write documentation <a class="el" href="repository_structure.html#writing-documentation">Guidelines</a>.</li>
<li><a class="el" href="repository_structure.html#coding-conventions">Coding conventions</a>.</li>
<li>Opening pull requests and writing commit messages Guidelines.</li>
<li>Code has to be reviewed before it is merged.</li>
<li>Make sure all tests pass when you send a pull request.</li>
<li>Participate in the code review process and address any feedback or comments.</li>
<li>Make sure <code>cmake --build . --target clang-format cpplint black isort </code> produces no errors.</li>
</ul>
<h3><a class="anchor" id="finding-a-task"></a>
Finding a Task</h3>
<ul>
<li>Check out the issues that have specifically been <a href="https://github.com/p4lang/p4c/issues?q=is%3Aopen+is%3Aissue+label%3Agood-first-issue">marked as being friendly to new contributors</a></li>
<li>Have a look at this README. Can it be improved? Do you see typos? You can open a PR.</li>
</ul>
<h2><a class="anchor" id="reporting-issues"></a>
Reporting Issues</h2>
<p>If you encounter any issues or have suggestions for improvement, please <a href="https://github.com/p4lang/p4c/issues">open an issue</a> with a clear description and, if possible, steps to reproduce.</p>
<h2><a class="anchor" id="feature-requests"></a>
Feature Requests</h2>
<p>We welcome feature requests! Please open an issue and provide as much detail as possible about the requested feature and its use case.</p>
<p>Happy coding!</p>
<h1><a class="anchor" id="coding-standard"></a>
Coding Standard</h1>
<p>When writing code in any language the most important consideration is readability. Code will be read by many more people and many more times than it will be written. So the goal is to write code that clearly and concisely describes what the code is doing, in terms of data structures, algorithms and interfaces. Expressing why the code is organized the way it is and how it achieves its goals is also necessary, and should be done in supporting documentation, as it cannot generally be expressed directly in the structure of the code. Having good supporting documentation is not an excuse for poorly written code, and well written code cannot make up for lacking documentation.</p>
<p>There are multiple modes in which people read code. They may read the code in depth to try to understand the algorithms used in the code, or they may scan over the code looking to understand the structure and interfaces of the code. Good coding style supports both kinds of readers. When writing code, you need to consider how that code appears to readers who have limited understanding of the code as well as readers who already mostly understand it. It should be easy for first-time readers to find where to start and for experienced readers to find the details they are looking for.</p>
<p>There are many different kinds of code involved in any project. Some code is important algorithms that program uses. Other code is primarily about building and managing data structures that algorithms operate on. Much code is "boilerplate"; code that exists primarily to make the compiler or build system work properly and is not really relevant to understanding the program or what it is trying to do. Code should ideally be designed so the scanning eye can easily separate the relevant, important code from the boilerplate.</p>
<p>Code should therefor be organized in "chunks" that can be though of as corresponding to paragraphs in written text. These chunks should be visible blocks in a superficial scan of the code, separated from each other by vertical white-space (blank lines). A chunk should be at least 3-5 lines (less than that doesn't convey adequate information or stand out enough from blank space), and at most 20-40 lines. These limits are not hard and fast rules, but guidelines &ndash; when writing code try to see how it appears to a surface scan trying to organize it visually in paragraph-style chunks.</p>
<p>Applying this to C++ code, a function may naturally express a chunk, or multiple chunks, or multiple small, related functions may be a chunk. Similarly, a class or struct definition may naturally be one or multiple chunks. This chunking informs where the brace characters should be placed, as brace by itself on a line makes a vertical space that separates chunks. So braces can be placed by themselves when they coincide with a chunk boundary, and should be placed with other text (generally the line above) when they do not.</p>
<p>Oftentimes, boilerplate code does not fit naturally into this chunking style &ndash; while you can have a chunk of boilerplate followed by a chunk of "real" code, doing this can interfere with readability. To the extent possible, boilerplate should be separated, to become part of the white-space between chunks. A one or two line (too small to be a real chunk) element between two chunks can be good for this.</p>
<p>C++ code contains many nested constructs (loops, conditions, classes, functions) that are delineated by brace ({..}) characters. These punctuation characters are easily missed on a quick scan or read of the code, so it is important to use indentation to make this nesting clear. Indentation should ALWAYS be kept consistent with code structure as defined by the braces, so the braces themselves can be ignored by the reader. At the same time, this nesting (and indentation) is really independent of the chunk/paragraph structuring of the code, so individual chunks can both contain indentation (for nested structure within a chunk) and be independently indented (for nested structures encapsulating multiple chunks). Too much indentation results in chunks that don't look like chunks, obscuring the vertical spacing that splits chunks, so any time indentation gets to more than 4-6 levels, it is a good indication that the code should be refactored.</p>
<p>When you look at a visual item with a repeating pattern, the brain tends to accentuate the pattern and edit out the differences. When you have code that is repetitive, this is pretty much exactly wrong &ndash; in repetitive code, the differences between the repeated things are usually what is important, while the repeating pattern is mostly less important. Thus, repeating (visual) patterns should usually be avoided. This is an aspect of the DRY (do not repeat yourself) principle in software engineering, since any repetition tends to lead to repeating patterns that are then harder to read.</p>
<h2><a class="anchor" id="commenting-the-code"></a>
Commenting the code</h2>
<p>Code comments should be meaningful and aid to the understanding of the code. We use <a href="http://www.doxygen.nl/manual/docblocks.html">Doxygen</a> style comments. Comments should reflect the programmer's intention (rather than enumerating the code) and the reasoning behind certain decisions. Comments should also capture invariants that are not directly visible in the code. There are arguments that code should be self-documenting, and indeed we encourage the writing of clean self-explanatory code. Comments should contribute the additional meaning that helps extensibility and maintainability by a large group of developers.</p>
<h2><a class="anchor" id="handling-errors"></a>
Handling errors</h2>
<p>The main goal of issuing errors and warnings is for the programmer to write correct P4 code. Errors and warnings should be <em>actionable</em>, i.e., the programmer needs to understand what was wrong with the program and if possible, get an idea on how to fix the problem. While error messages are not intended to replace learning the language and reading the language specification, there are many instances in which the compiler messages really help emphasizing certain semantics aspects that are overlooked. Therefore, please take the time to think through the information you want to convey and write good, explicit error messages.</p>
<p>An additional goal of the P4C compiler is to provide as many error messages as possible in one go. Therefore, while there is support for <code>FATAL_ERROR</code>s, it is desirable to try to continue execution and report all possible errors, using the <code>error</code> and <code>warning</code> calls. With the free form implementation of error messages, repeated passes of the compiler will then issue the same message multiple times. This results in frustrating the programmer.</p>
<p>To address the repeated message issue, as of Dec 2018, we introduce error/warning types. They classify the errors and impose a format that allows the compiler to automatically filter repeated messages. The filtering is based on the type of error and the source code location of the object that reports the error. Thus, it allows multiple error types per source code line, and ensures that only one error is reported even if the message is raised multiple times. We encourage compiler developers to use this method for issuing errors. The error codes and formats are defined in <code>lib/error_catalog.[h,cpp]</code>. Backends can extend the codes and formats as needed (and they are encouraged to do so).</p>
<p>Most of the errors as of Dec 2018 are written in free form: they use the <code>boost::format</code> for the format argument, which has some compatibility for <code>printf</code> arguments. These functions handle IR and SourceInfo objects smartly. Here is an example:</p>
<div class="fragment"><div class="line"> ++</div>
<div class="line">IR::NamedRef *ref;</div>
<div class="line">error(ErrorType::ERR_INVALID,</div>
<div class="line">      <span class="stringliteral">&quot;%1%: No header or metadata named &#39;%2%&#39;&quot;</span>, ref-&gt;srcInfo, ref-&gt;name);</div>
</div><!-- fragment --><p>output:</p>
<div class="fragment"><div class="line">missing_decls1.p4(6): [-Werror=invalid] Error: No header or metadata named &#39;data&#39;</div>
<div class="line">    if (data.b2 == 0) {</div>
<div class="line">        ^^^^</div>
</div><!-- fragment --><p>To ease the transition to typed errors and warnings, free form messages whose first argument (<code>%1%</code>) is an <code>IR::Node</code> (or more precisely a class that implements <code>Util::IHasSourceInfo</code> interface), will be converted automatically to typed errors that use the format argument of the message rather than the error catalog predefined formats.</p>
<h2><a class="anchor" id="git-commits-and-pull-requests"></a>
Git commits and pull requests</h2>
<p>Git histories are a beautiful tool to understand design decisions and build a knowledge base for resolving issues. Commit messages allow relating issues to resolutions and to explain the resolutions to everyone. Writing good commit messages takes some practice, fortunately, there are a number of simple guideline steps that go a long way. Universally, the recommendation is to use a 50 character summary line, followed by a detailed explanation of your commit, why it is necessary (link to the relevant issue), how it addresses the issue, what are its implications. For a more detailed exposure, including guidelines on how to express the text, see this <a href="http://chris.beams.io/posts/git-commit/">blog post</a>.</p>
<p>Github pull requests (PRs) created based on a single commit will inherit the commit message, and thus allow your reviewers to understand the work done without chasing multiple other issues, email messages, etc. Multi-commit PRs do not have this feature, however, we encourage you to cut and paste from your commit messages and provide a synopsis of what the PR is trying to accomplish. It is also strongly recommended that multi-commit PRs squash all their commits in to a single commit when merged. The Github web interface makes it very easy to do, and allows you to edit the final commit message directly in the browser.   </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
