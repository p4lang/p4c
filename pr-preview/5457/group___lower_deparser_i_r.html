<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>P4 Compiler Documentation (P4C): LowerDeparserIR</title>
<link rel="icon" href="p4-fav.svg" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--  Add link to paragraphs   -->
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
  DoxygenAwesomeParagraphLink.init()
</script>
<!-- Add copy button to code fragments  -->
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
  DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add dark mode toggle -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
</script>
<!-- Add interactive TOC -->
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
  DoxygenAwesomeInteractiveToc.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-interactive-toc.js" rel="stylesheet" type="text/css"/>
<link href="cards.css" rel="stylesheet" type="text/css"/>
<link href="flow.css" rel="stylesheet" type="text/css"/>
<link href="p4c_custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="p4-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">P4C
   </div>
   <div id="projectbrief">The P4 Compiler</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('group___lower_deparser_i_r.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle"><div class="title">LowerDeparserIR<div class="ingroups"><a class="el" href="group__parde.html">Parser &amp; deparser</a> &raquo; <a class="el" href="group___lower_parser.html">LowerParser</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Replace deparser IR with lowered version that references containers instead of fields.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for LowerDeparserIR:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="group___lower_deparser_i_r.svg" width="294" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:class_coalesce_learning" id="r_class_coalesce_learning"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#class_coalesce_learning">CoalesceLearning</a></td></tr>
<tr class="memdesc:class_coalesce_learning"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces consecutive extracts of the same container with a single extract.  <a href="#class_coalesce_learning">More...</a><br /></td></tr>
<tr class="separator:class_coalesce_learning"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r" id="r_struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r">Parde::Lowered::ComputeLoweredDeparserIR</a></td></tr>
<tr class="memdesc:struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates lowered deparser IR with container references.  <a href="#struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r">More...</a><br /></td></tr>
<tr class="separator:struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:struct_parde_1_1_lowered_1_1_replace_deparser_i_r" id="r_struct_parde_1_1_lowered_1_1_replace_deparser_i_r"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#struct_parde_1_1_lowered_1_1_replace_deparser_i_r">Parde::Lowered::ReplaceDeparserIR</a></td></tr>
<tr class="memdesc:struct_parde_1_1_lowered_1_1_replace_deparser_i_r"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replace deparser IR with lowered version.  <a href="#struct_parde_1_1_lowered_1_1_replace_deparser_i_r">More...</a><br /></td></tr>
<tr class="separator:struct_parde_1_1_lowered_1_1_replace_deparser_i_r"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:struct_parde_1_1_lowered_1_1_rewrite_emit_clot" id="r_struct_parde_1_1_lowered_1_1_rewrite_emit_clot"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#struct_parde_1_1_lowered_1_1_rewrite_emit_clot">Parde::Lowered::RewriteEmitClot</a></td></tr>
<tr class="memdesc:struct_parde_1_1_lowered_1_1_rewrite_emit_clot"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replace Emits covered in a CLOT with EmitClot.  <a href="#struct_parde_1_1_lowered_1_1_rewrite_emit_clot">More...</a><br /></td></tr>
<tr class="separator:struct_parde_1_1_lowered_1_1_rewrite_emit_clot"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Replace deparser IR with lowered version that references containers instead of fields. </p>
<p>Generate a lowered version of the parser IR in this program and swap it in in place of the existing representation.</p>
<p>The pass does this by:</p><ol type="1">
<li>Replacing field/checksum emits that are covered by CLOTs with EmitClot objects.</li>
<li>Generating lowered version of the deparser and swapping them in.</li>
<li>Coalescing the learning digest to remove consecutive uses of the same container. </li>
</ol>
<hr/><h2 class="groupheader">Class Documentation</h2>
<a name="class_coalesce_learning" id="class_coalesce_learning"></a>
<h2 class="memtitle"><span class="permalink"><a href="#class_coalesce_learning">&#9670;&#160;</a></span>CoalesceLearning</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class CoalesceLearning</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Replaces consecutive extracts of the same container with a single extract. </p>
<p>Copyright (C) 2024 Intel Corporation</p>
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at</p>
<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
<p>Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.</p>
<p>SPDX-License-Identifier: Apache-2.0</p>
<p>Digests cannot extract from the same 16 or 32 bit PHV consecutively, but for learning digests, since we control the layout completely, we can set it up to just extract the container once, and use the data from that container more than once.</p>
<p>This pass detects consecutive extracts of the same container and replaces them with a single extract, rewriting the control-plane info to match. In theory we could combine any extracts from the same container (not just adjacent ones) to reduce the number of digest bytes needed </p>
</div><div class="dynheader">
Inheritance diagram for CoalesceLearning:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="class_coalesce_learning__inherit__graph.svg" width="148" height="183"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>

</div>
</div>
<a name="struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r" id="struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r">&#9670;&#160;</a></span>Parde::Lowered::ComputeLoweredDeparserIR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Parde::Lowered::ComputeLoweredDeparserIR</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Generates lowered deparser IR with container references. </p>
<p>Generate the lowered deparser IR by splitting references to fields in the high-level deparser IR into references to containers. </p>
</div><div class="dynheader">
Inheritance diagram for Parde::Lowered::ComputeLoweredDeparserIR:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="struct_parde_1_1_lowered_1_1_compute_lowered_deparser_i_r__inherit__graph.svg" width="254" height="198"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr><td colspan="2"><h3>Public Member Functions</h3></td></tr>
<tr class="memitem:ae3d69d05b5eea92fe56f4c2e6a909acc" id="r_ae3d69d05b5eea92fe56f4c2e6a909acc"><td class="memItemLeft" align="right" valign="top"><a id="ae3d69d05b5eea92fe56f4c2e6a909acc" name="ae3d69d05b5eea92fe56f4c2e6a909acc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ComputeLoweredDeparserIR</b> (const <a class="el" href="class_phv_info.html">PhvInfo</a> &amp;phv, const <a class="el" href="class_clot_info.html">ClotInfo</a> &amp;clotInfo)</td></tr>
<tr class="separator:ae3d69d05b5eea92fe56f4c2e6a909acc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><h3>Public Attributes</h3></td></tr>
<tr class="memitem:a2e86a1096c3de75957525907358e4b3e" id="r_a2e86a1096c3de75957525907358e4b3e"><td class="memItemLeft" align="right" valign="top"><a id="a2e86a1096c3de75957525907358e4b3e" name="a2e86a1096c3de75957525907358e4b3e"></a>
std::map&lt; gress_t, std::map&lt; const IR::BFN::EmitChecksum *, unsigned &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>checksumInfo</b></td></tr>
<tr class="separator:a2e86a1096c3de75957525907358e4b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe70ed0c6fe5531af6152794b692ee5c" id="r_afe70ed0c6fe5531af6152794b692ee5c"><td class="memItemLeft" align="right" valign="top"><a id="afe70ed0c6fe5531af6152794b692ee5c" name="afe70ed0c6fe5531af6152794b692ee5c"></a>
IR::BFN::LoweredDeparser *&#160;</td><td class="memItemRight" valign="bottom"><b>egLoweredDeparser</b></td></tr>
<tr class="separator:afe70ed0c6fe5531af6152794b692ee5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36d8982e1d5aa824ef7fb642745d3c46" id="r_a36d8982e1d5aa824ef7fb642745d3c46"><td class="memItemLeft" align="right" valign="top"><a id="a36d8982e1d5aa824ef7fb642745d3c46" name="a36d8982e1d5aa824ef7fb642745d3c46"></a>
IR::BFN::LoweredDeparser *&#160;</td><td class="memItemRight" valign="bottom"><b>igLoweredDeparser</b></td></tr>
<tr class="memdesc:a36d8982e1d5aa824ef7fb642745d3c46"><td class="mdescLeft">&#160;</td><td class="mdescRight">The lowered deparser IR generated by this pass. <br /></td></tr>
<tr class="separator:a36d8982e1d5aa824ef7fb642745d3c46"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>

</div>
</div>
<a name="struct_parde_1_1_lowered_1_1_replace_deparser_i_r" id="struct_parde_1_1_lowered_1_1_replace_deparser_i_r"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_parde_1_1_lowered_1_1_replace_deparser_i_r">&#9670;&#160;</a></span>Parde::Lowered::ReplaceDeparserIR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Parde::Lowered::ReplaceDeparserIR</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Replace deparser IR with lowered version. </p>
<p>Replace the high-level deparser IR version of each deparser with the lowered version generated by ComputeLoweredDeparserIR. </p>
</div><div class="dynheader">
Inheritance diagram for Parde::Lowered::ReplaceDeparserIR:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="struct_parde_1_1_lowered_1_1_replace_deparser_i_r__inherit__graph.svg" width="264" height="183"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr><td colspan="2"><h3>Public Member Functions</h3></td></tr>
<tr class="memitem:ad9e7d8789661c91cb95eff2222ac9b67" id="r_ad9e7d8789661c91cb95eff2222ac9b67"><td class="memItemLeft" align="right" valign="top"><a id="ad9e7d8789661c91cb95eff2222ac9b67" name="ad9e7d8789661c91cb95eff2222ac9b67"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ReplaceDeparserIR</b> (const IR::BFN::LoweredDeparser *igLoweredDeparser, const IR::BFN::LoweredDeparser *egLoweredDeparser)</td></tr>
<tr class="separator:ad9e7d8789661c91cb95eff2222ac9b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>

</div>
</div>
<a name="struct_parde_1_1_lowered_1_1_rewrite_emit_clot" id="struct_parde_1_1_lowered_1_1_rewrite_emit_clot"></a>
<h2 class="memtitle"><span class="permalink"><a href="#struct_parde_1_1_lowered_1_1_rewrite_emit_clot">&#9670;&#160;</a></span>Parde::Lowered::RewriteEmitClot</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct Parde::Lowered::RewriteEmitClot</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Replace Emits covered in a CLOT with EmitClot. </p>
<p>This pass visits the deparsers, and for each deparser, it walks through the emits and identifies checksums/fields that are covered as part of a CLOT. Elements that are covered by a CLOT are removed from the emit list and are replace by EmitClot objects. </p>
</div><div class="dynheader">
Inheritance diagram for Parde::Lowered::RewriteEmitClot:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="struct_parde_1_1_lowered_1_1_rewrite_emit_clot__inherit__graph.svg" width="246" height="183"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr><td colspan="2"><h3>Public Member Functions</h3></td></tr>
<tr class="memitem:a604e9e671f341af60965f8567013cf48" id="r_a604e9e671f341af60965f8567013cf48"><td class="memItemLeft" align="right" valign="top"><a id="a604e9e671f341af60965f8567013cf48" name="a604e9e671f341af60965f8567013cf48"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>RewriteEmitClot</b> (const <a class="el" href="class_phv_info.html">PhvInfo</a> &amp;phv, <a class="el" href="class_clot_info.html">ClotInfo</a> &amp;clotInfo)</td></tr>
<tr class="separator:a604e9e671f341af60965f8567013cf48"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
