<!-- HTML header for doxygen 1.12.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>P4 Compiler Documentation (P4C): DPDK Backend</title>
<link rel="icon" href="p4-fav.svg" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--  Add link to paragraphs   -->
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript">
  DoxygenAwesomeParagraphLink.init()
</script>
<!-- Add copy button to code fragments  -->
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript">
  DoxygenAwesomeFragmentCopyButton.init()
</script>
<!-- Add dark mode toggle -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="cards.css" rel="stylesheet" type="text/css"/>
<link href="flow.css" rel="stylesheet" type="text/css"/>
<link href="p4c_custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="p4-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">P4C
   </div>
   <div id="projectbrief">The P4 Compiler</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dpdk_backend.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">DPDK Backend</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1 empty">
    <ul>
      <li class="level2">
        <a href="#how-to-use-it">How to use it?</a>
      </li>
      <li class="level2">
        <a href="#known-issues-1">Known issues</a>
        <ul>
          <li class="level3">
            <a href="#unsupported-language-features">Unsupported Language Features</a>
          </li>
          <li class="level3">
            <a href="#unsupported-psa-externs-and-features">Unsupported PSA externs and features</a>
          </li>
          <li class="level3">
            <a href="#dpdk-target-limitations">DPDK target limitations</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#contacts">Contacts</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p>The <b>p4c-dpdk</b> backend translates the P4-16 programs to DPDK API to configure the DPDK software switch (SWX) pipeline. DPDK introduced the SWX pipeline in the DPDK 20.11 LTS release. For more information, please refer to the <a href="https://doc.dpdk.org/guides/rel_notes/release_20_11.html">release note</a>.</p>
<p>The p4c-dpdk compiler accepts P4-16 programs written for the Portable Switch Architecture (PSA) and Portable NIC Architecture (PNA) (see the <a href="https://p4.org/specs">P4.org specifications page</a> for the PSA and PNA specification document).</p>
<p>The backend for dpdk reuses code from the p4c-bm2 "common" library for handling the PSA/PNA architecture. Internally, it translates the PSA/PNA program to a representation that conforms to the DPDK SWX pipeline and generates the 'spec' file to configure the DPDK pipeline.</p>
<h2><a class="anchor" id="how-to-use-it"></a>
How to use it?</h2>
<p>A sample P4 program can be found in the <a href="./examples"><code>examples</code> directory</a>. To generate the 'spec' file: </p><div class="fragment"><div class="line">p4c-dpdk --arch psa vxlan.p4 -o vxlan.spec</div>
</div><!-- fragment --><p>To load the 'spec' file in dpdk follow the instructions in the <a href="https://doc.dpdk.org/guides/sample_app_ug/pipeline.html">Pipeline Application User Guide</a>.</p>
<h2><a class="anchor" id="known-issues-1"></a>
Known issues</h2>
<h3><a class="anchor" id="unsupported-language-features"></a>
Unsupported Language Features</h3>
<ul>
<li>Subparsers</li>
<li>Parser Value Sets</li>
</ul>
<h3><a class="anchor" id="unsupported-psa-externs-and-features"></a>
Unsupported PSA externs and features</h3>
<ul>
<li>egress parser, control, and deparser are not implemented, only ingress parser, control, and deparser. There is no packet replication engine or packet buffer (the combination of which is sometimes called a traffic manager).</li>
<li>Packet Digest</li>
<li>Random</li>
<li>Hash</li>
<li>Timestamp</li>
<li>Direct Meter</li>
<li>Direct Counter</li>
<li>Basic Checksum</li>
<li>Packet Cloning/Recirculation/Resubmission</li>
</ul>
<h3><a class="anchor" id="dpdk-target-limitations"></a>
DPDK target limitations</h3>
<ul>
<li>Currently, programs written for DPDK target should limit the functionality in Ingress blocks, in case non empty Egress blocks are present it will be ignored by default unless Hidden temporary option <code>--enableEgress</code> used. When egress block support gets added to the DPDK target, and compiler can generate separate spec file for non empty ingress and egress blocks then option <code>--enableEgress</code> will be removed.</li>
<li>DPDK architecture assumes the following signatures for programmable block of PSA. P4C-DPDK converts the input program to this form.</li>
</ul>
<div class="fragment"><div class="line"> 4</div>
<div class="line">parser IngressParser (packet_in buffer, out H parsed_hdr, inout M user_meta);</div>
<div class="line"> </div>
<div class="line">control Ingress (inout H hdr, inout M user_meta);</div>
<div class="line"> </div>
<div class="line">control IngressDeparser (packet_out buffer, inout H hdr, in M meta);</div>
<div class="line"> </div>
<div class="line">parser EgressParser (packet_in buffer, out H parsed_hdr, inout M user_meta);</div>
<div class="line"> </div>
<div class="line">control Egress (inout H hdr, inout M user_meta);</div>
<div class="line"> </div>
<div class="line">control EgressDeparser (packet_out buffer, inout H hdr, in M meta);</div>
</div><!-- fragment --><ul>
<li>Size of all structure fields to be multiple of 8 bits and should not be greater than 64-bit. (This limitation is planned to be removed by grouping fields into fields which are multiple of 8-bits)</li>
<li>Combination of header and metadata as table key is not allowed. (This limitation is removed by P4C by copying the differing match key fields to metadata)</li>
<li>Extract instruction in DPDK target with 2 arguments expects the second argument to be the number of bytes to be extracted into the varbit field of the header. In P4 the second argument of the extract method is the number of bits. Compiler generates instructions which compute the size in bytes from the value in bits. If the value in bits is not a multiple of 8, the value is rounded down to the lower multiple of 8 bits.</li>
<li>Currently dpdk target does not support standard count and execute methods for Counter and Meter externs as defined in PSA and PNA specifications. It requires packet length as parameter in count and execute methods. <div class="fragment"><div class="line">PNA_MeterColor_t dpdk_execute(in S index, in PNA_MeterColor_t color, in bit&lt;32&gt; pkt_len);</div>
</div><!-- fragment --> <div class="fragment"><div class="line">void count(in S index, in bit&lt;32&gt; pkt_len);</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="contacts"></a>
Contacts</h2>
<p>Han Wang <a href="#" onclick="location.href='mai'+'lto:'+'han'+'2.'+'wan'+'g@'+'int'+'el'+'.co'+'m'; return false;">han2.<span class="obfuscator">.nosp@m.</span>wang<span class="obfuscator">.nosp@m.</span>@inte<span class="obfuscator">.nosp@m.</span>l.co<span class="obfuscator">.nosp@m.</span>m</a></p>
<p>Cristian Dumitrescu <a href="#" onclick="location.href='mai'+'lto:'+'cri'+'st'+'ian'+'.d'+'umi'+'tr'+'esc'+'u@'+'int'+'el'+'.co'+'m'; return false;">crist<span class="obfuscator">.nosp@m.</span>ian.<span class="obfuscator">.nosp@m.</span>dumit<span class="obfuscator">.nosp@m.</span>resc<span class="obfuscator">.nosp@m.</span>u@int<span class="obfuscator">.nosp@m.</span>el.c<span class="obfuscator">.nosp@m.</span>om</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
