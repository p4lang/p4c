# For any of these input packets, the only change from input packet to
# output packet should be the value of field h1.h2_valid_bits.  It
# should have a 1 in bit position i if h2[i] was valid after parsing.

# packet with 2 h2 headers should have h2_valid_bits=3 in output.

packet 0  01 00 00 00 ff 02   02 de ad 02   02 be ef 03   03 be

# This is what output packet _should_ be.  Both h2 headers in the
# input packet should be extracted, the first in the sub-parser, the
# second in the top level parser.  The first should go into h2[0], the

expect 0  01 00 00 00 03 02   02 de ad 02   02 be ef 03   03 be

# This is the actual output packet with latest p4c and
# behavioral-model as of 2017-Jan-08.  The BMv2 JSON file generated by
# p4c-bm2-ss copies header stack h2 into and out of the sub-parser by
# copying the 5 headers, but does not copy the 'next' state of the
# header stack, so the second h2 header extracted in the top level
# parser overwrites the first h2 header extracted in the subparser,
# into array stack element h2[0].

expect 0  01 00 00 00 01 02   02 be ef 03   03 be
